<h1>User Profile</h1>
<div class="row align-items-center">
  <div class="col-md-3 text-center">
    <img src="https://utahpulse.com/wp-content/uploads/2021/07/61-Sexy-Photos-of-Streamer-Pokimane-You-Will-Ever-See.webp" alt="profile image" class="rounded-circle" style="max-width: 100%; max-height: 100%;">
  </div>
  <div class="col-md-9">
    <p><strong>Name:</strong> <%= @user.email.split('@').first %></p>
    <p><strong>Account Created:</strong> <%= @user.created_at.to_date %></p>
    <p><strong>Email:</strong> <%= @user.email %></p>
  </div>
</div>

<style>
  .rounded-circle {
    border-radius: 50%;
    object-fit: cover;
    height: 100px;
    width: 100px;
  }
</style>


    <% if @listings.nil? %>
      <p>No listings found.</p>
    <% elsif @listings.any? { |listing| !listing.reviews.empty? } %>
      <% sum = 0 %>
      <% count = 0 %>
      <% @listings.each do |listing| %>
        <% if !listing.reviews.empty? %>
          <% sum += listing.average_rating.to_f %>
          <% count += 1 %>
        <% end %>
      <% end %>
      <p><strong>Overall average rating:</strong> <%= (sum/count).round(2) %></p>
    <% else %>
      <p>No reviews for this User</p>
    <% end %>
  </div>
</div>

<h2>Listings</h2>
<% if @listings.nil? %>
  <p>No listings found.</p>
<% else %>
  <div class="row">
    <% @listings.each do |listing| %>
      <div class="col-md-4 mb-4">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title"><%= listing.name %></h5>
            <p class="card-text"><%= listing.description %></p>
            <a href="<%= product_path(listing) %>" class="btn btn-primary">View</a>
            <%= link_to "Edit", edit_product_path(listing), class: "btn btn-secondary" %>
            <%= link_to "Delete", product_path(listing), method: :delete, data: { confirm: "Are you sure you want to delete this listing?" }, class: "btn btn-danger" %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
<% end %>


<h2>Bookings</h2>
<% if @bookings.nil? %>
  <p>No bookings found.</p>
<% else %>
  <ul>
    <% @bookings.each do |booking| %>
      <li>
        <%= link_to booking.product.name, product_path(booking.product) %>
        <%= link_to "Delete", product_booking_path(booking.product, booking), method: :delete, data: { confirm: "Are you sure you want to delete this booking?" }, class: "btn btn-danger" %>
      </li>
    <% end %>
  </ul>
<% end %>
